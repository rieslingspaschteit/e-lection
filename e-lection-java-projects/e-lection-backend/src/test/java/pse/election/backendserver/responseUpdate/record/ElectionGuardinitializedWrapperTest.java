package pse.election.backendserver.responseUpdate.record;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.mockito.Mockito.when;

import com.sunya.electionguard.ElectionCryptoContext;
import com.sunya.electionguard.Group;
import com.sunya.electionguard.Manifest;
import electionguard.ballot.Guardian;
import java.time.Instant;
import java.util.Date;
import java.util.List;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import pse.election.backendserver.core.service.ElectionService;
import pse.election.backendserver.core.service.TrusteeService;
import pse.election.backendserver.entity.Election;
import pse.election.backendserver.entity.Trustee;
import pse.election.backendserver.payload.response.record.ElectionGuardInitializedWrapper;
import pse.election.backendserver.payload.response.record.ElectionGuardManifestWrapper;

public class ElectionGuardinitializedWrapperTest {

  long electionId = 12L;
  @Mock
  Trustee trustee1;
  @Mock
  Trustee trustee2;
  @Mock
  Trustee trustee3;
  @Mock
  private ElectionService electionService;
  @Mock
  private TrusteeService trusteeService;
  @Mock
  private Election election;
  @Mock
  private ElectionGuardManifestWrapper manifestWrapper;

  @InjectMocks
  private ElectionGuardInitializedWrapper wrapper;

  @InjectMocks
  private ElectionGuardManifestWrapper wrapper2;

  @BeforeEach
  public void setup() {
    MockitoAnnotations.openMocks(this);
    when(electionService.getElection(electionId)).thenReturn(election);
    when(election.getElectionId()).thenReturn((long) 12);
    when(election.getPublicKey()).thenReturn(Group.hex_to_p_unchecked(
            "8D863279CBADF91BCFB5CE19DD5A6C1202D243786B296629015AEB8177D9FD7F7FA0F885AFE65C877195EF4C31168902DD31C07D2CB5F242537E6565571D53B4ED2FDEAF0BA7FE7040341CC95EC8C19D03EC6A890EF175C7E3C686336460D5A55D625217604E3B04A8A7D2667D53FA6464DFCFA8289A0B0F5A60BD4C1E511CEA44557A86B5F6A5F21FAE816963D0D5CE2D93D317B8282CDCFE4F39634AD53476CC464A60F52BD64AD26FFB90CDA7163ED49CF645996CAB0D584C67946E72D3E1ED6DB1B8EB1685559A918717E88221B678654D1B86D982B365BB427EB1794C151CCEAF760DF37DF919BDC0748302A7F78E9D05EC701D36A44F801EA802A1EE49B28D65BAC30010C486DEF546BD6F7C1AAB911593F94A4DF6AE769B254B27473688C7A1121CD8FA7B9920213F25FB7103FD08D6D84C7F0BCC5B9323FCE3D008A973C57CEA0CF9C6F18567309CE186BCC2EFC671E531BAB9ACE0A3421CDE166E11A83E6075BE991ECB31C3B8BFC540055F63839AA15AEA09A7CC306C14B8F94CDA93653837316BA85B5FDF3D7919CB5A8512AC310C1D1E040BA3E56D233787B36AEABD841029A1D35452D364962D36FDE74F2E7966E5E8189EC2428C0752DF112A317F09E97A375487B95E4F34F8462C9FF57EC18BE09BFDD9197C08C1B4755C0707FF87478E981E5D3ED09CEF62690ABBB3211610568320C84AB7E40D5DD97E7D")
        .getBigInt());
    when(election.getTrusteeThreshold()).thenReturn(2);
    when(election.getStartTime()).thenReturn(Date.from(Instant.parse("2022-12-23T13:12:00Z")));
    when(election.getEndTime()).thenReturn(Date.from(Instant.parse("2022-12-25T13:12:00Z")));

    Manifest manifest = wrapper2.generateElectionGuardManifest(election.getElectionId());
    when(manifestWrapper.generateElectionGuardManifest(election.getElectionId())).thenReturn(
        manifest);
    when(trustee1.getPublicElgamalKeyAndProof()).thenReturn(List.of(
        "0;6A6873B20406BDEA9A53BEC7E6D0A591A590A17A103310284F2F0C853E16BFE2BC2BCDE5C46DA6ABEAC412AD70CCBC2C6951B7C6B393FB5B2C243D1ABC5A030B91B341A8C5E0D519BA15A189468C57E295152B65EE4AC0297DD8BD230E92EF34DA582EB8A4349C398910D30CB428C79EEC8FCA60DC411F85A84E88C8141CD618D8CD60A17DC92C8540C20C28EC21B1304AB281D34B0B624A5BF0F947FD9D26F82E8997DA48CCFCF2A6A57D2576EE0AD829CE25BDDA28E552CE60773ADA8BF44FAD2A228DC0DABF9F33D948848FF11CB6CBA664065CB91A86F3F6FF70476F4A5B9C2750AF9DB05F2CE9D0351F4DB2E2F91420B92285A2507EFBD15DB53018C1AF262500DF912D3C7EFEFEEEC2360DD6F608A6F832E541C6A66AF5996A692E38FA0B6E13255C5956148FA68BEEDBCFAF62A19AACAF9826E1CB317D9F453AE50BFC85ADB74E1102047D9770BDD6574CB794D2AD01C4E638397A2EA87175973FE2266B6DD51DFE872447D25DA720E77B4D9573A229BBBFED5A431FC609FF9D97A8D0F9FFF2029026C6A648DB2B9FC9CF006D1FB7A472DD352DB295230944CEC81C8736AD03158467631EC4C5156B74FCC17950ECCD9A2570E99BF8D17E943E2182C474171729C9785BE8E32D147B1612AF91B3D83E16D4B392987009F9428C3FA905DCE98395F6B9D51BAA91CB0292A6CDA2135381B119423B311F018D2FDA5C294A;906177A5237C6A602AA5C6D1CBBD4D408071189F597D3BA066C425754C59B35CC25F6C88715751F358A82B02B141F10AC928AED1CF71343B1CDB4FE2AC39A5037C80F7FA53D8852419B238CEF60061DB11BC5385B7024E1ABC5ED5A21ADC6BC57001489B599369735F2B4D240DC4F5788EEDA31CB736D3EB78F8E499412C95C712A52997E224F6A808684F061064F63FCAA7A3AF67C98AA1900E26F06C8335042BA9BF64DF73267AAFFDAB32D8E5FEE9EA7911DAD21EB21361BB92603A0ECD6DA9195C13E8A468146B3D2AB64EC9560DBA84F486592E2CEBD514AF1B132C50B794A5C3A75BBBDCCE6A8D163F0179064ED70852FC5CB771D2167F7C6A1CAD4F52280EB17720D61A6EEF6C093E7D619C59942593F140BAB7AC9E4E79C1AB5E57BD59E01748CD8DC2C855B11C9ECD21AE08C1BC6672AD139209DFA9808649256B25A410B5D7C049FCCDD2548344E586A5F72EA058CB38779D19A19B95505875FC34C897F0ABD217662EC3FD4625B0240A54C23E253EF9F6D49874AE9677D2048167B31E10D448807105E7E8FDDAF8146B3909575B74A69A26A0E8513E5AE8A9054438E2C6D77195FD896DD8E707F2A7A2A81696072AFCB89933272029207BD01B1789932B63710F916C322D3CCEB0849D48DEB5977080F2ADF3E8D00605F75084630664D1F0F8AE1C763B0A94869EDD2FC35A830D92B3FB54A797BA753563A75ED9;4E31315C41E659FB65CC90D889F69DF86767C681EC3723ABB2990B9B0F37239C;F9362FB19D5E34EBBFE120E8868B17C416B87C6EBAE9BE84E1AF79FFFD4063C5",
        "1;F97EDB99862AFC70CF2AF8805554A720576E84BFEAE7536003EF5815F10484DB2008F225E39969049BE7F43CB00DFEE2AE7489C2E8C0B5C4B14CC546A680AA75796DC2FAB10E2C791F1C07EA966D036FFB9B78A55C3865FB5791BFB81A3CA68EBD13B5E3A4E03A49B90EEBC55C857FAB7E67309B9E2E6042073E89E40422D14C5150EAE8CB47ED7AF432B7741CA1B32A5DD369431FF693BB43CA580B8718FA59D0C08B62FADBA51CA9F8BDD521DC31EDC0778C86DD3450064972F346FE5A7507CCCCF68373710013C5837748743C8E3AC0D6F700112DF0C37CC2300C1DAD8A0E78B6C381D550CBBDCE6BB2506E21A0E81837585EECDD18D6DA619D157C14791D34A6BFD7CA10506893ADE3BD754F1A86C1B75C3A09DF2F12E24405F99D4ABFA954595CBEE9A64A916D34B8B1C6F3B31E7FC31944547F68E774035200E7729418DB9E79BB357D6645019AA4B85FCC84D1D38D03DFD0D2D783F88C1FFDE4608C1ACE3BE3772CDC727999649DD2F896506F032934642CA60F54BD2375FFFC8A11E6714867F0FDC5A99DE22EF46477B3A177FA4366C95CE21F32FE71F8EC9157687E0366731CB44D5AC579011AE5DE6470142AA7B0BA332EDB1CFB40343D545C50DCC44079D25D6AD36565030E5EBB783BD40348B994FFB0E29BDC203AA39F155CCA3267B9A5F286EF23B68CBD82F49CF62A5E4586A8C1B8033346C0842AF0ADEBD1;0D362C355409EA2835DB37281022BF3E794D882DC5A9C1E9A5D9C8F3E1DCAD1652BB2CDEEB1F798A14B1E050B88F40F43FD0F330EF4271693A2348F6BB4A947C5A03176A6CC6AD19C85A61171A282A4EFC09B121CFE89585A52416BC1336E93F259306D9E78E45779D0980A09FB0E87D6959B72E725B60A9215202EDC0DEBC2FA6D13472C45D8B58EC0F5C628A7F24C0D1E0887CF3E0B22934A715B3502BE5045CBEC83D70A0D3FECEF28ADFDC5738FF2B9199F8A2C09FDABC6B4482CED67F90A7FD73BEBD1D62AB2671EDFB0B6E6B0916AA9F09B09CFC328737F04F93975FDA938D6D925DDA3743BF58C1353B86AB5B649ACC583A25102AB839D48753469E6D9A6A2ED61D596C0465EE3D76C2184905695E6BF7C1E17C03F348BAF56CCDEF9E79A8421DC3A5C135192037C38C15B01EF4214C58A330094F9DF1D989752A07989D57B1756C4ACAFEEBFE93902553690A5F8393887BEDCB7601564464B46CE15755D1C65D26F88EE292355C9D0E3A599DDF2BB97F6B9818FB372A336A84BBA95FAC909929853B5517A498D95A9B9F904CD2942B7AC43554700204618ED293E224CABA18B3BEC075A96409D467FBBA58C897E7885720AFB317AF8ED0AF21B5D0CA34D3D88C391C811EA34291EBCEA9DB89ABCA88426AAB0EF63B7B35C10FD7AA5C054DCA4FB2C115ACF62ABD9C611B57EDD176B307A4EE4DC7F26840719611B4F9;E474EACE17D8D61A9A09ED6084F0C27FB0624A8B5D29C22D968959ADF99406F2;1A76FC39FDFF85A9B2602B1452C1B505D0790DD2B709A3945ACDDEEA1A5450E2"

    ));
    when(trustee1.getTrusteeId()).thenReturn((long) 21);
    when(trustee1.getIndex()).thenReturn(1);

    when(trustee2.getPublicElgamalKeyAndProof()).thenReturn(List.of(
        "0;F632324DE60FE8696015B14E90EF2F7028FFA342019869232737F72759A76E28395B1D2F2E28BCF2AF2CB8DB371F059F97E677E82F9D9061309CCF33F4E64F0F9FA29DF6EFD91707ABAA4AFB4F6AEE7963F35F9DFFAF2D0BC30618806B68096B23315E93A73F82C0808B63277DF6F90CA0BCE21DB0A6C615B374FF291E1E2608014FE22004CB0AE11EE8822F3FF865A417D92FD1132C058AC3C0C5F013B2120ABFC311C6FCBA1A75792810119F6B9BC8040C8381474CEDEE33205800DF3E88CA78B891D14EAE7E3B279320E9527BA3F9CB7A444CA9B5187501B40DB0D3F06EBB68E7E2425FE96C1514B80D5E22DD0270169E1C6468B27787FAA079C41EE3A954A7E008F73152F684E75AE60637DE28849288689C854201F3EE7E946408B02E0F5A407847B9DA8E6C3F12BBFCCEB57B54CC0F97410420C788F1C433C4B7E3DFF0ECF2BFF32E7EE59C6DDE9EE6232CA716CED5A596D27D99EB43E4CB5A668BB296B66152004BAD388BB622FC68DA975F1653DCBAB770911D9C42E4C434124EA56E76F927A8C9AFC62D7994EB8F47CE76AB56C4D102F5D9AA8B3DBA61EC127CBED66ED01D7D2EFE500E01B79E449CBBA1D26394ABB7DFBFB734464AFD449087B5EA67923866DCD86C5CA3AF438D9CA03541C99F2F85F7C74E7A69F5026986220A4FBB0DD56CAB1FEA2C4C7BA24EB1604005D8D2A86524461CBF7906E8FD71E41FA8;B1E37F4EF546A10DB2D492F6DC36842C7115EFC4AFCCD9F6BD2E20C7B2C7A512E153212B335CA0AB2C80C9F3C4A2814A7B41D9D404D9CD7CC6E6B53DB591BA74736D96922B03C7588268776DFDF2BD3C1E69322D5A3A37AC99131A3039844DC8578FB6A3B7DDA3A43183D044A0E57074F5B2C757BC5068BC6FAFD44D6C931DED4D99FD23971E6037FEE4809C761AC8CC10A69E09DB27B073BC0719B0F77A16AB6A44F1559FF744C1F03C0CF002923A635AD18BE6897F2855860F13782CB2F255DBA64DEF5DFF63772CB3EE242C7541B9DCC1758707834739C1783CB7CEE43AC2EDCC67C0E077A558EAB22876695F05E7C547F15001752F9B7CBFD89B26A7F72F06E4A7FCCEDA7DF98FB3912AE5A792F88A909ABDDC29D3234F74C9DD5C5550F4CE247E2BE52974171A6D42AE52FA29712C460571A65D4A2754415B3C537C49FAECB6D069BE3AFA33B9BD6B6ABF14483DB2201DBF55883729CAC66DF557FD845AE919152DD2CA163DE9E5C31FB32DB7787EF8EB81E0DC9093035EA98D9F5A0EBD6725ED65557D3A4A45E9DB393D38FDA671C93F891DB8C0407DFECA42A640F350C4EEE236C425FC9B0071456C71D5B37DCACD5C52AEB13066F85A34BC657B494385ADD0510815D6E93DDA5DE264BC6BFBEC02CB64F234025A2A5535E694704772D0E960BCE11CA2CD780F2815A370F91590AE6D2768225633003857E131DC9FD7;E749B6312F5CE3FEA925C8E00F698B532BC4C23359D393D37B21440881E31725;EE882B64D363F8379E450F29EDEC461334F855E593A1F5BD8284A4BF2D429348",
        "1;1387C0282E376C1BB4A27C69AC9DF472B9638AE439F4DD6E544B8600273F9EACCB4D2050B4F016B597FDDBDF54A4931980A7DB8E4BAE4A344A1BF78DB711DA80D407FEA8A8C671603C14789B2C655AC2CDEF256DD5094F1D05AAA37FEFC7E72859097A80E0294514B8FEEE7E18FB34F1C98C6C8881592E76D7ED826A233C9E69A9D3BFD185E2F48B86A99EC45883A83BE3AC0582D4E78C8DA02D104624E9C53A7ECCF239AD3A7ECD21CB5CF55219A9675A76C239742F78BF3B74BFD360A963C7BE16EBEE3DBD2ED75F7361C12BF06593E72CE18D80D5F4609C11BA132FF8A5514DCF511CE83B2B57161F8D7F68E2E6B8924B28BBC640DAFC989A8B60C8848B47BAB83CA9AE3133AB77C67F83C9C40AFFABFB6E2202A89BAB03E072E6598AB9AC14761B6FBAB396D4CA3B2C0D651F40287EA06282A4677D6E0020184ED900817E4C2E484F201B3311C36E4438B8BEE4DC28C52612282F212ECAE4FD26D0CB086599D7093E81E5090F4E569EE9C6F2E6290FD11D17FE3D5CD7BF4F33E8F7DD9AEAEADCB6D1575C9840089DBDFB7CE38E8985D32C88A84EA1926534B0D18791B37284E8AB8414E27112B2DFF50FF8C6ACCEAEDB62E62C7D7F7D1ABA9203E6AE46691F7E409B77438E048538AACABCCFB10092701BBAEA1CDC35D7914D923C1CA199A64B33DCDF6BF353A9FB09EF80429D0039DE639DE8CDE5466141EFE99FE57D40;7C2FB1C7F6C02959C9C7CC6B8B36EEB372F0F7267DFE44B718A7659DDC21DC000B6557537321A73D63DBD62B91E4B0D2CC038C9ADF9F57E36BC964B326E1CB00F37682D8A01DAA13BF1C9A2C9DA0F524357038FF8495052AAA1DD48664B3A5FD11AEE0852526AB2C07A7B434452456D5C5C3A2F500A9C11F9146FADB9BC3D207790152E3E05333673F09C4394C42A371DD04294BA77B45AE0B23BB33E0D0B5543F609ABE14DDFFF4FCF28E706E7935B5DD224DC3A6BC74654D48B3296007FF5AFA4C8322E0ACADC7F2FA742BE824FE73341FECA34D9AC0A483ABC3EFD441EB67DD40DA618F8F5AE35B67153FDFB12E6CD97BE3F4C13BA9238456CC18F6280736FC4DB511D8E069E153DD6AF2858654A9552D9B7EE96E07CAEF7B3E60F651D33E0F022460384D681B8EA5F25028BF2D4A4F16A8F17661B1841DA2D1CD3F1A13F896A675D96FA41D827FFDF2BB8F91E788477DB4E951A0DDBC0F2264785E749B74734A5A27A37A287EEAAC6231CDF1F852C511BD15939EE24A8381E4E99541A2DBA7CE837E46A2E5D5FF0AEBB9B9131A7F146E59B39125DC330106CB3EDBA2805ED41F962BDC355EF7924C2D1CD3AC0384F04E94B17C3C21D6FEB44806E622499CE2F2B22C4A3D7ED7BE9BBCFCCE86BD181B861F8A73721AEBB74DA09DA04DEAA96FC2BDD1BF4BAFE525EB0AF5BAA550099EC93AA4429168B640B6A3392DD69827;5E5FA86C5186EC7E59644518DEAC7AE573252846F627F8CD01F8EDB1E1DA537F;1662796C8292F896DDABA71EE76CCAF20D0657A117BE4A5FE9AB267E6EF00B36"

    ));
    when(trustee2.getTrusteeId()).thenReturn((long) 22);
    when(trustee2.getIndex()).thenReturn(2);

    when(trustee3.getPublicElgamalKeyAndProof()).thenReturn(List.of(
        "0;B3CAF8AA5336727B82D05C1A330251620C3B7FF7A14AC82F958769E89A113487EBEB4D72F1A630E90A5D70E8465559CA5F16D75A99D77AEC0242420F6F590FA84256F5AF763809A171CA7CDBFE18068540EE9BA5E045927723A09044E6E927C6A738E393FB7B999542CCA6AFE39E2943C555034976CF93C10B9DC841C712356448ED7994A2A57A3B94A072E61DF06B0D220DA26C358A757E1C0B09C6796CE501ABF0322EE84492E558F1BEA39AB43C826E9456E3F313AE27BD871F8537063FD369785B6622BA5110C48241270A4A62EC5613CEBE8B1D257C8AA132AB045789E674BB45E4BAEE3D3C50ADC64944B5D1A4B22F1094CDA105EE134819F500373E5AB66884B863A54449FBBF558B113B55D421E537773FD000C5A8AC3F85FF06092586676A96AB913A067E4B39A193DABA1D6B14755B8FBADADB9C09276AFA63677777D80599842DCA0A2B9665E7C902FE750A2B8619CE2B77EA4C27F28616E515FEF517E1F5D1876E9B796243FFEF651E7676E7F0BC34E970A7C0CD8F8FAB89F09BA33F01CDB66FC4414DD6C817E9FF5D7FE561321ADA68596CD35A15DC0F7F28AEA7F5DE7496D10367AB46138E684F27DBF4512400D5E0BE51410E418DFBED8E96DE4385CB4A7B0BD34E9CC72F1CA6792F294263BD26BD7D185FBD04FD0336F5C54BD5AE404B076A276CA2574C40F16A41CB5FAC14708DAAEDB8FFB19A748FCB37;B5A3CCBFFF97683A78C2E000870DB814BDD8AC6223A2273182156AAD46026BE3DA73E1DA12EBF2FC7DF3BD18EB7A8224B6194B86BEA4D9E4BF5795B41630F9DAF67FE9189887B4E03D7D4AD0B6687267F081CB7C42C4FC31A13327A6C2A94F5FAD4C31A515D1E873D1D13AE7B9210C12CD09F9B10DD322911B2B1CF7EC96138BD348EF9F2A7ECE519161D3072FD814E3CAF95CD46430F0A5AE46478946BA2528E4969AB79849C26B2CB088CB645774B1C1B7BE99F8DB3A6F73A46FAB9690D54328AC7FE4363A48F36DC933098FAC31F56E12AA0E4BF652FEED45CDE659D06C01C7F0AB5915480B7060C2102124523A94B61077E057978601183C233837517759055EEC6095C975551B38A7CF264E3FD9E22895C660422F6CE5064C5BA7F6C4366EE4C43A53727B8494019392E65381C09CCB3D7C9A11A03E1B373C704D8CE1740F82A996DB8D27C5D62C36B11BC292549C3C908FF992FE4FC90BE637002EAF0B32D845A3098A294B8FE8D7475D35DC3938CD016C5A759FC72B72FA0F27D49C2CF79C0A412FA93D8497FC4059146FE3123D1179A0C8CE049552A2CFC256E7173DEA49BC714F3CF7279A80B7517AF6434E683F9E36DFAA3DF288FF0DB5F792499E119AB193F5B9B1F598CBB7987E1AC325F43F84E24270417F3FB3D691232ACA3CC49042053D9FD982E04F4DE06F9C6FF33278E43FCC25FBAA6ABC02555E2392D7;CF57446DFAE7DEAA54289ACBF8EAA127A392D417DA33E500029C7F0887877EB9;45AD925768825B2B0B8E39E03A34393C54B45B2FCE7167413AC9660CB36679AD",
        "1;51722E8347DF023C9DD00427E43E2ACE16D9DD46E0A5838E2C0122CAAAF92741813F0E968DA976D7E9E60E23F4FE3800279526CBAA13D7D9FD5735E9E7E8E187249E1F6AD17540B940A89EC35C9DB0B19E1E9765D543742FC11F00344F5DBBA42DA19DA38634C83B61F2C01A949B13CF64DA2D8827E45A97BB994F6E2681C883B862C4DCDB607783C726690048FC7C4823E4F23DE9627BF261B466674969E3BF9A6BD36701F4023543E8FBEB333CE9E155699AAB6407109548A67AE7D199E4B6BD217D0EE8A3CD0F4D7ED7AE475852C57D21F30260A37F2F5195E90350C7DB4A44D3BB0395E7DB2665BC4FC80B907A9DA1664374DF3BDECF910AB4AA1E206524BAAB7C797461D11A0B1BFB3ADE1BB6D5E6C3FF05E25A1F1B2DF89B40594402808B8E691914C403FE1B6A481F69EB2A5099D21EF32DA25633899E896341B9344BEDE1265E8283035911557C0A2450396EDE3623DAFF64C7FD02219AD359D0B3237FEF1EF7ED39930E7404C634ED381624E91D1517ADC030FA2FAAB0C7E7C6BED513F96A8EAC5044FB60F056606606DE5AF384B2C5BB8B21F925C3E8861964F4A0EDFE01414E25DBA4AE1C772BEDDEF8CFD195D94AEF4C18EB70A9622CA73719FACD6EA70DFB9BDB7178D8FAB65F969A2565F9096D1B2A73DB04A32CD0CEAC81FFA2BF6640CF2B0BF820E15209AF73F0D3B32F0AF4E16E3C1F60C97611FE77F8E4;89E8B3AA583F93E17DB8908DE7BBA7AB8C270B836D6BED65061FFBFC29BB42C2D768DD371E81B4D0128DF45886091C5FD43370648710755FE2A699D3064A6EEB4B92AC67AE3A9AD881F2109CAC7F1478281FA00B4836B568BF50435041920205651C35E9EF0A9677F8ADBFCE36B27C5A867C90275327C4D3FD47351503B51A9A60A7EADCD5179D73048A87C358B52F4D23DBC8C79F7F14B2C15F1D2047A446BB3B2018B6EA6BCF1331B8C7645631C41F29BEEACD76FB377A9CCF75C377C2A91E853A0EBCD1994B33629BA638DFEE286BC51141680CEDAE46FB99D98E759625AB6867D10588F3A701EB5F2BCC103C25CD8CBB5944E978F4F73734D46F23D3B8CEB69D3BBD71D4D4C37186C08A22E9FD492EEC1AEDE45176181ADB09B843DED90C14BD341962D1E7951C9ACA528899EC7383CB5C966A60B50E8B77C7A54E8FB360DF22234676A214051E11DC5CAE189F96832513A3B4337157459F9D25F8EF174BA80AFECBF8F013836881F27E963B75BEC04BE1B934F75CA45A8AB87A4EFD31D4CE49420F7A7790FA64A0D4B6F579648B045F2C8F0435E148649457882132D2FED58A572DA072854FDA3575A79EA1D9294E5A8983D0825AE8A0282A42B703D6755412019A50D3A88DE35B4E3710A95D3AB105EC72665EBF4E7D7632A891F1F0AA8B1BC48FEFB8FFEE85B7DE77CB6F9D88860795214C740151970D03126BDE4D88;E610D5B29FCF71DE7A699490C6B4DD1863FAB185CF05E58EA94F1D70B4934F50;2D3118E77BBC8B1A16383FDA7AE0E0C6AE5144E2FCB28C6C00C0BB184D41AD47"
    ));
    when(trustee3.getTrusteeId()).thenReturn((long) 23);
    when(trustee3.getIndex()).thenReturn(3);

    when(trusteeService.getTrustee("t1", (long) 12)).thenReturn(trustee1);
    when(trusteeService.getAllTrustees((long) 12)).thenReturn(List.of(trustee1,
        trustee2, trustee3));

  }

  @Test
  public void generateGuardianTest() {
    Guardian guardian = wrapper.generateGuardian(electionId, "t1");
    assertEquals(guardian.getXCoordinate(), 1);
    List<Group.ElementModP> keys = List.of(Group.hex_to_p_unchecked(
            "6A6873B20406BDEA9A53BEC7E6D0A591A590A17A103310284F2F0C853E16BFE2BC2BCDE5C46DA6ABEAC412AD70CCBC2C6951B7C6B393FB5B2C243D1ABC5A030B91B341A8C5E0D519BA15A189468C57E295152B65EE4AC0297DD8BD230E92EF34DA582EB8A4349C398910D30CB428C79EEC8FCA60DC411F85A84E88C8141CD618D8CD60A17DC92C8540C20C28EC21B1304AB281D34B0B624A5BF0F947FD9D26F82E8997DA48CCFCF2A6A57D2576EE0AD829CE25BDDA28E552CE60773ADA8BF44FAD2A228DC0DABF9F33D948848FF11CB6CBA664065CB91A86F3F6FF70476F4A5B9C2750AF9DB05F2CE9D0351F4DB2E2F91420B92285A2507EFBD15DB53018C1AF262500DF912D3C7EFEFEEEC2360DD6F608A6F832E541C6A66AF5996A692E38FA0B6E13255C5956148FA68BEEDBCFAF62A19AACAF9826E1CB317D9F453AE50BFC85ADB74E1102047D9770BDD6574CB794D2AD01C4E638397A2EA87175973FE2266B6DD51DFE872447D25DA720E77B4D9573A229BBBFED5A431FC609FF9D97A8D0F9FFF2029026C6A648DB2B9FC9CF006D1FB7A472DD352DB295230944CEC81C8736AD03158467631EC4C5156B74FCC17950ECCD9A2570E99BF8D17E943E2182C474171729C9785BE8E32D147B1612AF91B3D83E16D4B392987009F9428C3FA905DCE98395F6B9D51BAA91CB0292A6CDA2135381B119423B311F018D2FDA5C294A"),
        Group.hex_to_p_unchecked(
            "F97EDB99862AFC70CF2AF8805554A720576E84BFEAE7536003EF5815F10484DB2008F225E39969049BE7F43CB00DFEE2AE7489C2E8C0B5C4B14CC546A680AA75796DC2FAB10E2C791F1C07EA966D036FFB9B78A55C3865FB5791BFB81A3CA68EBD13B5E3A4E03A49B90EEBC55C857FAB7E67309B9E2E6042073E89E40422D14C5150EAE8CB47ED7AF432B7741CA1B32A5DD369431FF693BB43CA580B8718FA59D0C08B62FADBA51CA9F8BDD521DC31EDC0778C86DD3450064972F346FE5A7507CCCCF68373710013C5837748743C8E3AC0D6F700112DF0C37CC2300C1DAD8A0E78B6C381D550CBBDCE6BB2506E21A0E81837585EECDD18D6DA619D157C14791D34A6BFD7CA10506893ADE3BD754F1A86C1B75C3A09DF2F12E24405F99D4ABFA954595CBEE9A64A916D34B8B1C6F3B31E7FC31944547F68E774035200E7729418DB9E79BB357D6645019AA4B85FCC84D1D38D03DFD0D2D783F88C1FFDE4608C1ACE3BE3772CDC727999649DD2F896506F032934642CA60F54BD2375FFFC8A11E6714867F0FDC5A99DE22EF46477B3A177FA4366C95CE21F32FE71F8EC9157687E0366731CB44D5AC579011AE5DE6470142AA7B0BA332EDB1CFB40343D545C50DCC44079D25D6AD36565030E5EBB783BD40348B994FFB0E29BDC203AA39F155CCA3267B9A5F286EF23B68CBD82F49CF62A5E4586A8C1B8033346C0842AF0ADEBD1"));
    assertEquals(keys, guardian.getCoefficientCommitments());
    assertTrue(guardian.getCoefficientProofs().get(0).isValidVer1());
    assertTrue(guardian.getCoefficientProofs().get(1).isValidVer1());
  }

  @Test
  public void generateContext() {
    ElectionCryptoContext context = wrapper.generateCryptoContext(electionId);
    assertNotNull(context.jointPublicKey);
    assertNotNull(context.commitmentHash);
    assertNotNull(context.cryptoBaseHash);
    assertEquals(3, context.numberOfGuardians);
    assertEquals(2, context.quorum);
  }
}
